---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by heyqule.
--- DateTime: 2/9/2021 7:49 PM
---

local ERM_UnitCapsuleHelper = {}

function ERM_UnitCapsuleHelper.add_capsule(unit_name, cooldown, stack_size)
    local base_entity = data.raw.unit[unit_name]
    local name = 'erm_'..unit_name
    data:extend({
        {
            type = "capsule",
            subgroup = "capsule",
            name = name,
            capsule_action = {
                attack_parameters = {
                    ammo_category = "capsule",
                    ammo_type = {
                        action = {
                            action_delivery = {
                                projectile = name,
                                starting_speed = 0.3,
                                type = "projectile"
                            },
                            type = "direct"
                        },
                        category = "capsule",
                        target_type = "position"
                    },
                    cooldown = cooldown,
                    projectile_creation_distance = 0.6,
                    range = 12,
                    type = "projectile"
                },
                type = "throw"
            },
            icons = {
                {icon = base_entity.icon, icon_size = base_entity.icon_size}
            },
            order = "u[unit-capsule]-"..name,
            stack_size = stack_size,
            localised_name = {"erm.unit-capsule", {"entity-name."..name}}
        },
        {
            type = "projectile",
            name = name,
            acceleration = 0.005,
            action = {
                action_delivery = {
                    target_effects = {
                        entity_name = unit_name,
                        show_in_tooltip = true,
                        type = "create-entity"
                    },
                    type = "instant"
                },
                type = "direct"
            },
            animation = {
                filename = "__base__/graphics/entity/poison-capsule/poison-capsule.png",
                frame_count = 1,
                height = 32,
                priority = "high",
                width = 32
            },
            flags = {
                "not-on-map"
            },
            light = {
                intensity = 0.5,
                size = 4
            },
            shadow = {
                filename = "__base__/graphics/entity/poison-capsule/poison-capsule-shadow.png",
                frame_count = 1,
                height = 32,
                priority = "high",
                width = 32
            },
            smoke = nil,
        },
    })
end

function ERM_UnitCapsuleHelper.add_recipe(unit_name, craft_time, ingredients)
    local base_entity = data.raw.unit[unit_name]
    local name = 'erm_'..unit_name
    data:extend({
        {
            type = "recipe",
            name = name,
            result = name,
            enabled = false,
            energy_required = craft_time,
            ingredients = ingredients,
            requester_paste_multiplier = 1,
            always_show_made_in = true,
            category = "erm_controlable_units"
        }
    })
end

function ERM_UnitCapsuleHelper.add_technology(unit_name, prerequisites, tech_unit)
    local base_entity = data.raw.unit[unit_name]
    local name = 'erm_'..unit_name
    data:extend({
        {
            type = "technology",
            name = name,
            effects = {
                {
                    type = "unlock-recipe",
                    recipe = name,
                },
            },
            icons = {
                {icon = base_entity.icon, icon_size = base_entity.icon_size}
            },
            order = "e-g",
            prerequisites = prerequisites,
            unit = tech_unit,
            localised_name = {"erm.unit-capsule", {"entity-name."..unit_name}}
        }
    })
end

return ERM_UnitCapsuleHelper