---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by heyqule.
--- DateTime: 11/8/2022 10:28 PM
---
require('__enemyracemanager__/global')

local increase_pop = {
    type = 'script',
    effect_id = ARMY_POPULATION_INCREASE
}
local decrease_pop = {
    type = 'script',
    effect_id = ARMY_POPULATION_DECREASE
}

for _, unit in pairs(data.raw['unit']) do
    if unit.subgroup == 'erm_controllable_units' then
        if (type(unit.dying_trigger_effect) == 'table') then
            table.insert(unit.dying_trigger_effect, decrease_pop)
        else
            unit.dying_trigger_effect = {
                decrease_pop
            }
        end

        if (type(unit.created_effect) == 'table') then
            table.insert(unit['created_effect']['action_delivery']['target_effects'], increase_pop)
        else
            unit.created_effect = {
                type = 'direct',
                action_delivery = {
                    type = 'instant',
                    target_effects = increase_pop
                }
            }
        end
    end
end