---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by heyqule.
--- DateTime: 10/23/2021 1:26 PM

local ErmForceHelper = require('lib.helper.force_helper')
local ErmUnitHelper = require('lib.unit_helper')

local damage_types = {
    {'kr-explosion', 10, 85},
    {'radioactive', 25, 70}
}

-- max resist 75
local controlable_subgroups = {
    ['erm_controlable_units'] = true
}

-- max resist 10 - 90
local enemies_subgroups = {
    ['enemies'] = true,
    ['erm-flying-enemies'] = true,
    ['erm-dropship-enemies'] = true,
    ['erm-builder-enemies'] = true,
}

local resistance_mutiplier = settings.startup["enemyracemanager-level-multipliers"].value

for _, unit in pairs(data.raw.unit) do
    if enemies_subgroups[unit.subgroup] and ErmForceHelper.is_erm_unit(unit) then
        local name = ErmForceHelper.split_name(unit.name)
        for _, damage_type in pairs(damage_types) do
            table.insert(unit.resistances,{ type = damage_type[1], percent = ErmUnitHelper.get_resistance(damage_type[2], damage_type[3], resistance_mutiplier, name[3])})
        end
    end
end

for _, unit in pairs(data.raw.unit) do
    if controlable_subgroups[unit.subgroup] and ErmForceHelper.is_erm_unit(unit) then
        for _, damage_type in pairs(damage_types) do
            table.insert(unit.resistances,{ type = damage_type[1], percent = 75})
        end
    end
end

