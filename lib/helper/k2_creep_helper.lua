---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by heyqule.
--- DateTime: 7/29/2021 11:46 PM
---
local ForceHelper = require('__enemyracemanager__/lib/helper/force_helper')

local K2CreepHelper = {}

function K2CreepHelper.generate_creep(surface, position)
    remote.call('kr-creep','spawn_creep_at_position', surface, position)
end

function K2CreepHelper.onChunkGenerated(event)
    local nests = event.surface.find_entities_filtered({
        type = "unit-spawner",
        area = event.area,
        force = ForceHelper.get_all_enemy_forces(),
    })

    for _, nest in pairs(nests) do
        K2CreepHelper.generate_creep(event.surface, nest.position)
    end
end

function K2CreepHelper.onSpawnerBuilt(event)
    local entity = event.entity

    if entity and entity.valid and entity.type == "unit-spawner" then
        log(entity.type..'/'..entity.name)
        K2CreepHelper.generate_creep(event.entity.surface, event.entity.position)
    end
end

return K2CreepHelper