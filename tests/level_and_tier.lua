---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by heyqule.
--- DateTime: 1/6/2024 5:02 PM
---

local LevelManager = require('__enemyracemanager__/lib/level_processor')
local TestShared = require('shared')



before_each(function()
    TestShared.prepare_the_factory()
end)

after_each(function()
    TestShared.reset_the_factory()
end)


describe("Level Manager", function()
    it("calculateLevels and calculateMutlipleLevels", function()
        global.race_settings['erm_vanilla'].evolution_base_point = 2
        LevelManager.calculateLevels()
        assert(global.race_settings['erm_vanilla'].level == 2, 'Level == 2')

        global.race_settings['erm_vanilla'].evolution_base_point = 10
        LevelManager.calculateLevels()
        assert(global.race_settings['erm_vanilla'].level == 3, 'Level == 3')

        global.race_settings['erm_vanilla'].evolution_base_point = 50
        LevelManager.calculateMultipleLevels()
        assert(global.race_settings['erm_vanilla'].level == 10, 'Level == 10')
    end)

    it("Tiers switch", function()
        local force = game.forces['enemy']
        force.evolution_factor = 0.41
        LevelManager.calculateLevels()
        assert(global.race_settings['erm_vanilla'].tier == 2, 'Tier == 2')

        force.evolution_factor = 0.81
        LevelManager.calculateLevels()
        assert(global.race_settings['erm_vanilla'].tier == 3, 'Tier == 3')
    end)
end)