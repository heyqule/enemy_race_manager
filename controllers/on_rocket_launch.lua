---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by heyqule.
--- DateTime: 2/15/2022 9:41 PM
---

require("__enemyracemanager__/global")

local GlobalConfig = require("__enemyracemanager__/lib/global_config")
local RaceSettingHelper = require("__enemyracemanager__/lib/helper/race_settings_helper")
local BossProcessor = require("__enemyracemanager__/lib/boss_processor")
local SurfaceProcessor = require("__enemyracemanager__/lib/surface_processor")

local OnRocketLaunched = {}

OnRocketLaunched.events = {
    [defines.events.on_rocket_launched] = function(event)
        if GlobalConfig.rocket_attack_point_enable() then
            local rocket = event.rocket
            if rocket and rocket.valid then
                local force_name = SurfaceProcessor.get_enemy_on(rocket.surface.name)
                if force_name then
                    RaceSettingHelper.add_to_attack_meter(force_name, GlobalConfig.rocket_attack_points())
                end
            end
        end

        --local item = event.rocket.get_inventory(defines.inventory.rocket).find_item_stack("psi-tracking-satellite")
        --if item and item.valid and item.name == "psi-tracking-satellite" then
        --    local surface = event.rocket_silo.surface
        --    surface.print("Psi Tracking Satellite Launched...")
        --    BossProcessor.exec(event.rocket_silo)
        --end
    end
}

return OnRocketLaunched